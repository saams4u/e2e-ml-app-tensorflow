2020-07-17 18:23:37.693100: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_101.dll

2020-07-17 18:23:41,155:INFO:train.py:<module>:146:
{
    "cuda": false,
    "seed": 1234,
    "shuffle": true,
    "data_url": "https://raw.githubusercontent.com/madewithml/lessons/master/data/news.csv",
    "lower": true,
    "char_level": false,
    "filters": "[!\\\"'#$%&()*\\+,-./:;<=>?@\\\\\\[\\]^_`{|}~]",
    "data_size": 1.0,
    "train_size": 0.7,
    "val_size": 0.15,
    "test_size": 0.15,
    "num_epochs": 10,
    "batch_size": 64,
    "embedding_dim": 100,
    "use_glove": true,
    "freeze_embeddings": false,
    "filter_sizes": [
        2,
        3,
        4
    ],
    "num_filters": 50,
    "hidden_dim": 128,
    "dropout_p": 0.1,
    "learning_rate": 0.0001,
    "patience": 3
}

2020-07-17 18:23:43,823:INFO:train.py:<module>:158:
Raw data:
  Sharon Accepts Plan to Reduce Gaza Army Operation, Haaretz Says World

2020-07-17 18:23:44,645:INFO:train.py:<module>:172:
Data splits:
	X_train: 78030, y_train: 78030
	X_val: 13770, y_val: 13770
	X_test: 16200, y_test: 16200

2020-07-17 18:23:45,571:INFO:train.py:<module>:183:
vocab_size: 28565

2020-07-17 18:23:46,751:INFO:train.py:<module>:192:
Text to indices:
  (raw) Chain Store Sales Rise in the Latest Week
  (preprocessed) chain store sales rise in the latest week
  (tokenized) [1922, 701, 58, 79, 3, 9, 498, 191]

2020-07-17 18:23:46,753:INFO:train.py:<module>:202:
classes:
  ['Business' 'Sci/Tech' 'Sports' 'World']

2020-07-17 18:23:46,765:INFO:train.py:<module>:218:
class counts:
  [19548 19497 19485 19500]
class weights:
  {0: 5.11561285041948e-05, 1: 5.128994204236549e-05, 2: 5.132152938157557e-05, 3: 5.128205128205128e-05}

2020-07-17 18:23:46,765:INFO:train.py:<module>:235:
Dataset generators:
  (training_generator) <DataGenerator(batch_size=64, batches=1220, shuffle=False)>
  (validation_generator) <DataGenerator(batch_size=64, batches=216, shuffle=False)>
  (testing_generator) <DataGenerator(batch_size=64, batches=254, shuffle=False)>
Sample batch:
  X: (64, 15)
  y: (64,)


2020-07-17 18:23:59,408:INFO:train.py:<module>:257:
GloVe Embeddings:
(28565, 100)
2020-07-17 18:23:59.491977: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library nvcuda.dll
2020-07-17 18:23:59.667153: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce GTX 1060 computeCapability: 6.1
coreClock: 1.6705GHz coreCount: 10 deviceMemorySize: 6.00GiB deviceMemoryBandwidth: 178.99GiB/s
2020-07-17 18:23:59.667700: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_101.dll
2020-07-17 18:23:59.699238: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_10.dll
2020-07-17 18:23:59.737450: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cufft64_10.dll
2020-07-17 18:23:59.751340: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library curand64_10.dll
2020-07-17 18:23:59.781586: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusolver64_10.dll
2020-07-17 18:23:59.799984: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusparse64_10.dll
2020-07-17 18:23:59.856636: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudnn64_7.dll
2020-07-17 18:23:59.858077: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-07-17 18:23:59.859992: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2
2020-07-17 18:24:00.276611: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2760724b450 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-17 18:24:00.276942: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-17 18:24:00.286732: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce GTX 1060 computeCapability: 6.1
coreClock: 1.6705GHz coreCount: 10 deviceMemorySize: 6.00GiB deviceMemoryBandwidth: 178.99GiB/s
2020-07-17 18:24:00.287202: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_101.dll
2020-07-17 18:24:00.287440: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_10.dll
2020-07-17 18:24:00.287644: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cufft64_10.dll
2020-07-17 18:24:00.287844: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library curand64_10.dll
2020-07-17 18:24:00.288047: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusolver64_10.dll
2020-07-17 18:24:00.288251: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusparse64_10.dll
2020-07-17 18:24:00.288464: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudnn64_7.dll
2020-07-17 18:24:00.289568: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2020-07-17 18:24:01.747193: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-17 18:24:01.747504: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2020-07-17 18:24:01.747633: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2020-07-17 18:24:01.749038: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4700 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060, pci bus id: 0000:01:00.0, compute capability: 6.1)
2020-07-17 18:24:01.805452: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2764108c890 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-17 18:24:01.805807: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce GTX 1060, Compute Capability 6.1
--- Logging error ---
Traceback (most recent call last):
  File "C:\Users\mahjo\AppData\Local\Programs\Python\Python36\Lib\logging\__init__.py", line 996, in emit
    stream.write(msg)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\encodings\cp1252.py", line 19, in encode
    return codecs.charmap_encode(input,self.errors,encoding_table)[0]
UnicodeEncodeError: 'charmap' codec can't encode character '\u2192' in position 141: character maps to <undefined>
Call stack:
  File "text_classification/train.py", line 165, in <module>
    "Preprocessed data:\n"
Message: 'Preprocessed data:\n  Sharon Accepts Plan to Reduce Gaza Army Operation, Haaretz Says \u2192 Sharon Accepts Plan to Reduce Gaza Army Operation , Haaretz Says'
Arguments: ()
--- Logging error ---
Traceback (most recent call last):
  File "C:\Users\mahjo\AppData\Local\Programs\Python\Python36\Lib\logging\__init__.py", line 996, in emit
    stream.write(msg)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\encodings\cp1252.py", line 19, in encode
    return codecs.charmap_encode(input,self.errors,encoding_table)[0]
UnicodeEncodeError: 'charmap' codec can't encode character '\u2192' in position 86: character maps to <undefined>
Call stack:
  File "text_classification/train.py", line 211, in <module>
    "Labels to indices:\n"
Message: 'Labels to indices:\n  Business \u2192 0'
Arguments: ()
wandb: ERROR wandb.init hasn't been called, can't configure run
2020-07-17 18:24:02.643036: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudnn64_7.dll
2020-07-17 18:24:05.125895: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: Invoking GPU asm compilation is supported on Cuda non-Windows platforms only
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
2020-07-17 18:24:05.164150: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_10.dll
Epoch 1/10
Traceback (most recent call last):
  File "text_classification/train.py", line 287, in <module>
    callbacks=callbacks, shuffle=False, class_weight=class_weights, verbose=1)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\site-packages\tensorflow\python\keras\engine\training.py", line 66, in _method_wrapper
    return method(self, *args, **kwargs)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\site-packages\tensorflow\python\keras\engine\training.py", line 848, in fit
    tmp_logs = train_function(iterator)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\site-packages\tensorflow\python\eager\def_function.py", line 580, in __call__
    result = self._call(*args, **kwds)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\site-packages\tensorflow\python\eager\def_function.py", line 627, in _call
    self._initialize(args, kwds, add_initializers_to=initializers)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\site-packages\tensorflow\python\eager\def_function.py", line 506, in _initialize
    *args, **kwds))
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\site-packages\tensorflow\python\eager\function.py", line 2446, in _get_concrete_function_internal_garbage_collected
    graph_function, _, _ = self._maybe_define_function(args, kwargs)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\site-packages\tensorflow\python\eager\function.py", line 2777, in _maybe_define_function
    graph_function = self._create_graph_function(args, kwargs)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\site-packages\tensorflow\python\eager\function.py", line 2667, in _create_graph_function
    capture_by_value=self._capture_by_value),
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\site-packages\tensorflow\python\framework\func_graph.py", line 981, in func_graph_from_py_func
    func_outputs = python_func(*func_args, **func_kwargs)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\site-packages\tensorflow\python\eager\def_function.py", line 441, in wrapped_fn
    return weak_wrapped_fn().__wrapped__(*args, **kwds)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\site-packages\tensorflow\python\framework\func_graph.py", line 964, in wrapper
    user_requested=True,
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\site-packages\tensorflow\python\autograph\impl\api.py", line 538, in converted_call
    converted_f = conversion.convert(target_entity, program_ctx)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\site-packages\tensorflow\python\autograph\impl\conversion.py", line 360, in convert
    free_nonglobal_var_names)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\site-packages\tensorflow\python\autograph\impl\conversion.py", line 275, in _convert_with_cache
    entity, program_ctx)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\site-packages\tensorflow\python\autograph\impl\conversion.py", line 511, in convert_entity_to_ast
    nodes, name, entity_info = convert_func_to_ast(o, program_ctx)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\site-packages\tensorflow\python\autograph\impl\conversion.py", line 673, in convert_func_to_ast
    node, source = parser.parse_entity(f, future_features=future_features)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\site-packages\tensorflow\python\autograph\pyct\parser.py", line 196, in parse_entity
    original_source = inspect_utils.getimmediatesource(entity)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\site-packages\tensorflow\python\autograph\pyct\inspect_utils.py", line 148, in getimmediatesource
    return ''.join(inspect.getblock(lines[lnum:]))
  File "C:\Users\mahjo\AppData\Local\Programs\Python\Python36\Lib\inspect.py", line 940, in getblock
    for _token in tokens:
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\tokenize.py", line 606, in _tokenize
    pseudomatch = _compile(PseudoToken).match(line, pos)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\tokenize.py", line 153, in _compile
    return re.compile(expr, re.UNICODE)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\re.py", line 233, in compile
    return _compile(pattern, flags)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\re.py", line 301, in _compile
    p = sre_compile.compile(pattern, flags)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\sre_compile.py", line 566, in compile
    code = _code(p, flags)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\sre_compile.py", line 551, in _code
    _compile(code, p.data, flags)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\sre_compile.py", line 146, in _compile
    _compile(code, p, (flags | add_flags) & ~del_flags)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\sre_compile.py", line 187, in _compile
    _compile(code, av, flags)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\sre_compile.py", line 146, in _compile
    _compile(code, p, (flags | add_flags) & ~del_flags)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\sre_compile.py", line 187, in _compile
    _compile(code, av, flags)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\sre_compile.py", line 146, in _compile
    _compile(code, p, (flags | add_flags) & ~del_flags)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\sre_compile.py", line 187, in _compile
    _compile(code, av, flags)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\sre_compile.py", line 128, in _compile
    code[skip] = _len(code) - skip
KeyboardInterrupt
