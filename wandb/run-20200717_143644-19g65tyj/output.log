
2020-07-17 14:36:57,465:INFO:train.py:<module>:146:
{
    "cuda": false,
    "seed": 1234,
    "shuffle": true,
    "data_url": "https://raw.githubusercontent.com/madewithml/lessons/master/data/news.csv",
    "lower": true,
    "char_level": false,
    "filters": "[!\\\"'#$%&()*\\+,-./:;<=>?@\\\\\\[\\]^_`{|}~]",
    "data_size": 1.0,
    "train_size": 0.7,
    "val_size": 0.15,
    "test_size": 0.15,
    "num_epochs": 10,
    "batch_size": 64,
    "embedding_dim": 100,
    "use_glove": true,
    "freeze_embeddings": false,
    "filter_sizes": [
        2,
        3,
        4
    ],
    "num_filters": 50,
    "hidden_dim": 128,
    "dropout_p": 0.1,
    "learning_rate": 0.0001,
    "patience": 3
}

2020-07-17 14:36:58,599:INFO:train.py:<module>:158:
Raw data:
  Sharon Accepts Plan to Reduce Gaza Army Operation, Haaretz Says World

2020-07-17 14:36:59,230:INFO:train.py:<module>:165:
Preprocessed data:
  Sharon Accepts Plan to Reduce Gaza Army Operation, Haaretz Says → Sharon Accepts Plan to Reduce Gaza Army Operation , Haaretz Says

2020-07-17 14:36:59,405:INFO:train.py:<module>:172:
Data splits:
	X_train: 78030, y_train: 78030
	X_val: 13770, y_val: 13770
	X_test: 16200, y_test: 16200

2020-07-17 14:37:00,182:INFO:train.py:<module>:183:
vocab_size: 28565

2020-07-17 14:37:01,114:INFO:train.py:<module>:192:
Text to indices:
  (raw) Chain Store Sales Rise in the Latest Week
  (preprocessed) chain store sales rise in the latest week
  (tokenized) [1922, 701, 58, 79, 3, 9, 498, 191]

2020-07-17 14:37:01,117:INFO:train.py:<module>:202:
classes:
  ['Business' 'Sci/Tech' 'Sports' 'World']

2020-07-17 14:37:01,131:INFO:train.py:<module>:211:
Labels to indices:
  Business → 0

2020-07-17 14:37:01,132:INFO:train.py:<module>:218:
class counts:
  [19548 19497 19485 19500]
class weights:
  {0: 5.11561285041948e-05, 1: 5.128994204236549e-05, 2: 5.132152938157557e-05, 3: 5.128205128205128e-05}

2020-07-17 14:37:01,133:INFO:train.py:<module>:235:
Dataset generators:
  (training_generator) <DataGenerator(batch_size=64, batches=1220, shuffle=False)>
  (validation_generator) <DataGenerator(batch_size=64, batches=216, shuffle=False)>
  (testing_generator) <DataGenerator(batch_size=64, batches=254, shuffle=False)>
Sample batch:
  X: (64, 15)
  y: (64,)


2020-07-17 14:37:13,205:INFO:train.py:<module>:257:
GloVe Embeddings:
(28565, 100)
Traceback (most recent call last):
  File "text_classification/train.py", line 287, in <module>
    callbacks=callbacks, shuffle=False, class_weight=class_weights, verbose=1)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\site-packages\tensorflow_core\python\keras\engine\training.py", line 819, in fit
    use_multiprocessing=use_multiprocessing)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\site-packages\wandb\keras\__init__.py", line 120, in new_v2
    return old_v2(*args, **kwargs)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\site-packages\tensorflow_core\python\keras\engine\training_v2.py", line 235, in fit
    use_multiprocessing=use_multiprocessing)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\site-packages\tensorflow_core\python\keras\engine\training_v2.py", line 593, in _process_training_inputs
    use_multiprocessing=use_multiprocessing)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\site-packages\tensorflow_core\python\keras\engine\training_v2.py", line 706, in _process_inputs
    use_multiprocessing=use_multiprocessing)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\site-packages\tensorflow_core\python\keras\engine\data_adapter.py", line 952, in __init__
    **kwargs)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\site-packages\tensorflow_core\python\keras\engine\data_adapter.py", line 767, in __init__
    dataset = standardize_function(dataset)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\site-packages\tensorflow_core\python\keras\engine\training_v2.py", line 660, in standardize_function
    standardize(dataset, extract_tensors_from_dataset=False)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\site-packages\tensorflow_core\python\keras\engine\training.py", line 2360, in _standardize_user_data
    self._compile_from_inputs(all_inputs, y_input, x, y)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\site-packages\tensorflow_core\python\keras\engine\training.py", line 2618, in _compile_from_inputs
    experimental_run_tf_function=self._experimental_run_tf_function)
TypeError: compile() got an unexpected keyword argument 'optimizer'
