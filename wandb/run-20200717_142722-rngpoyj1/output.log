
2020-07-17 14:27:35,381:INFO:train.py:<module>:146:
{
    "cuda": false,
    "seed": 1234,
    "shuffle": true,
    "data_url": "https://raw.githubusercontent.com/madewithml/lessons/master/data/news.csv",
    "lower": true,
    "char_level": false,
    "filters": "[!\\\"'#$%&()*\\+,-./:;<=>?@\\\\\\[\\]^_`{|}~]",
    "data_size": 1.0,
    "train_size": 0.7,
    "val_size": 0.15,
    "test_size": 0.15,
    "num_epochs": 10,
    "batch_size": 64,
    "embedding_dim": 100,
    "use_glove": true,
    "freeze_embeddings": false,
    "filter_sizes": [
        2,
        3,
        4
    ],
    "num_filters": 50,
    "hidden_dim": 128,
    "dropout_p": 0.1,
    "learning_rate": 0.0001,
    "patience": 3
}

2020-07-17 14:27:36,761:INFO:train.py:<module>:158:
Raw data:
  Sharon Accepts Plan to Reduce Gaza Army Operation, Haaretz Says World

2020-07-17 14:27:37,380:INFO:train.py:<module>:165:
Preprocessed data:
  Sharon Accepts Plan to Reduce Gaza Army Operation, Haaretz Says → Sharon Accepts Plan to Reduce Gaza Army Operation , Haaretz Says

2020-07-17 14:27:37,558:INFO:train.py:<module>:172:
Data splits:
	X_train: 78030, y_train: 78030
	X_val: 13770, y_val: 13770
	X_test: 16200, y_test: 16200

2020-07-17 14:27:38,351:INFO:train.py:<module>:183:
vocab_size: 28565
text_classification/train.py:187: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  X_train = np.array(X_tokenizer.texts_to_sequences(X_train))
text_classification/train.py:188: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  X_val = np.array(X_tokenizer.texts_to_sequences(X_val))
text_classification/train.py:189: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  X_test = np.array(X_tokenizer.texts_to_sequences(X_test))

2020-07-17 14:27:39,336:INFO:train.py:<module>:192:
Text to indices:
  (raw) Chain Store Sales Rise in the Latest Week
  (preprocessed) chain store sales rise in the latest week
  (tokenized) [1922, 701, 58, 79, 3, 9, 498, 191]

2020-07-17 14:27:39,339:INFO:train.py:<module>:202:
classes:
  ['Business' 'Sci/Tech' 'Sports' 'World']

2020-07-17 14:27:39,350:INFO:train.py:<module>:211:
Labels to indices:
  Business → 0

2020-07-17 14:27:39,352:INFO:train.py:<module>:218:
class counts:
  [19548 19497 19485 19500]
class weights:
  {0: 5.11561285041948e-05, 1: 5.128994204236549e-05, 2: 5.132152938157557e-05, 3: 5.128205128205128e-05}

2020-07-17 14:27:39,354:INFO:train.py:<module>:235:
Dataset generators:
  (training_generator) <DataGenerator(batch_size=64, batches=1220, shuffle=False)>
  (validation_generator) <DataGenerator(batch_size=64, batches=216, shuffle=False)>
  (testing_generator) <DataGenerator(batch_size=64, batches=254, shuffle=False)>
Sample batch:
  X: (64, 15)
  y: (64,)


2020-07-17 14:27:50,689:INFO:train.py:<module>:257:
GloVe Embeddings:
(28565, 100)
Epoch 1/10
Traceback (most recent call last):
  File "text_classification/train.py", line 287, in <module>
    callbacks=callbacks, shuffle=False, class_weight=class_weights, verbose=1)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\site-packages\wandb\keras\__init__.py", line 120, in new_v2
    return old_v2(*args, **kwargs)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\site-packages\tensorflow\python\keras\engine\training.py", line 66, in _method_wrapper
    return method(self, *args, **kwargs)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\site-packages\tensorflow\python\keras\engine\training.py", line 848, in fit
    tmp_logs = train_function(iterator)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\site-packages\tensorflow\python\eager\def_function.py", line 580, in __call__
    result = self._call(*args, **kwds)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\site-packages\tensorflow\python\eager\def_function.py", line 627, in _call
    self._initialize(args, kwds, add_initializers_to=initializers)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\site-packages\tensorflow\python\eager\def_function.py", line 506, in _initialize
    *args, **kwds))
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\site-packages\tensorflow\python\eager\function.py", line 2446, in _get_concrete_function_internal_garbage_collected
    graph_function, _, _ = self._maybe_define_function(args, kwargs)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\site-packages\tensorflow\python\eager\function.py", line 2777, in _maybe_define_function
    graph_function = self._create_graph_function(args, kwargs)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\site-packages\tensorflow\python\eager\function.py", line 2667, in _create_graph_function
    capture_by_value=self._capture_by_value),
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\site-packages\tensorflow\python\framework\func_graph.py", line 981, in func_graph_from_py_func
    func_outputs = python_func(*func_args, **func_kwargs)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\site-packages\tensorflow\python\eager\def_function.py", line 441, in wrapped_fn
    return weak_wrapped_fn().__wrapped__(*args, **kwds)
  File "C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\site-packages\tensorflow\python\framework\func_graph.py", line 968, in wrapper
    raise e.ag_error_metadata.to_exception(e)
AttributeError: in user code:

    C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\site-packages\tensorflow\python\keras\engine\training.py:571 train_function  *
        outputs = self.distribute_strategy.run(
    C:\Users\mahjo\e2e-ml-app-tensorflow\text_classification\models.py:83 train_step  *
        self.optimizer.apply_gradient(zip(grads, self.trainable_weights))
    C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\site-packages\tensorflow\python\keras\optimizer_v2\optimizer_v2.py:678 __getattribute__
        raise e
    C:\Users\mahjo\e2e-ml-app-tensorflow\venv\lib\site-packages\tensorflow\python\keras\optimizer_v2\optimizer_v2.py:668 __getattribute__
        return super(OptimizerV2, self).__getattribute__(name)

    AttributeError: 'Adam' object has no attribute 'apply_gradient'

